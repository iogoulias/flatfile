  <label for="fname">Client:</label>
  <input type="text" id="fname" name="fname"><br><br>
<button onclick="importer.requestDataFromUser().then(function(results) { 
    console.log(results.data)
    importer.displaySuccess('Thanks for uploading your data!')
})">Start Import</button>

<script src="https://unpkg.com/@flatfile/adapter/build/dist/index.min.js"></script>

<script>
const importer = new FlatfileImporter("bd4ed93e-83cb-4d62-a5b7-4a18ebdb9ce2", {
  type: "imports",
  fields: [
      {key: "firstname", label: "First name"},
	  {key: "lastname", label: "Name"},
	  {key: "email", label: "Email", validators:[{validate:'regex_matches',regex:"^\\w+([-+.']\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$",error: 'Invalid Email Format or Empty Field'}]},
	  {key: "city", label: "City"},
	  {key: "country", label: "Country"},
	  {key: "sessiontitle", label: "SessionTitle"},
	  {key: "sessiondate", label: "SessionDate",validators:[{validate:'regex_matches',regex:"^(0[1-9]|[12][0-9]|3[01])[/](0[1-9]|1[012])[/](19|20)[0-9][0-9]$",error: 'Invalid Date Format or Empty Field'}]},
	  {key: "sessionfrom", label: "SessionFrom",validators:[{validate:'regex_matches',regex:"^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",error: 'Invalid Time Format or Empty Field'}]},
	  {key: "sessionto", label: "SessionTo", validators:[{validate:'regex_matches',regex:"^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$",error: 'Invalid Time Format or Empty Field'}]},
	  {key: "sessiontype", label: "SessionType"},
	  {key: "room", label: "Room"},
	  {key: "sessionid", label: "SessionID"},
    ],
  managed: true,
  devMode:true
});
var client=document.getElementById('fname').value;
if (client==null || client=="") {
client=12345;
}
importer.setCustomer({userId: client});

importer.registerRecordHook(record => {
  let out = {}
  if (record.sessiondate && record.sessiondate!="" && record.sessiondate!=null && (record.sessiondate).match("(0[1-9]|[12][0-9]|3[01])[/](0[1-9]|1[012])[/](19|20)[0-9][0-9]")==null ) {
    out.sessiondate = {
      value: new Date(record.sessiondate).toLocaleDateString('fr'),
      info: [
        {
          message: 'Fixed Date Format',
          level: 'info'
        }
      ]
    }
  }
  if ( record.sessionfrom!=null && (record.sessionfrom).match(/\d\d:\d\d/gi)!=null && record.sessionfrom!=(record.sessionfrom).match(/\d\d:\d\d/gi)[0] ) {
  out.sessionfrom = {
      value: record.sessionfrom!=(record.sessionfrom).match(/\d\d:\d\d/gi)[0],
      info: [
        {
          message: 'Fixed Time Format',
          level: 'info'
        }
      ]  
  }
  }
  if ( record.sessionto!=null && (record.sessionto).match(/\d\d:\d\d/gi)!=null && record.sessionto!=(record.sessionto).match(/\d\d:\d\d/gi)[0] ) {
  out.sessionto = {
      value: record.sessionto!=(record.sessionto).match(/\d\d:\d\d/gi)[0],
      info: [
        {
          message: 'Fixed Time Format',
          level: 'info'
        }
      ]  
  }
  }
  return out
})
</script>
